---
title: "Focal K36me2"
output:
  html_document:
    toc: true
    toc_float: true
    collapsed: false
    number_sections: false
    toc_depth: 3
    smooth_scroll: false
    theme: cerulean
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(reshape2)
library(tidyverse)
library(reactable)
library(data.table)
```

---

# Genes at residual QKO peaks {.tabset}
<ul>
  <li>After filtering for genes > 1 FPKM, 84 genes are identified overlapping these 119 QKO K36me2 residual peaks. </li>
</ul>

## QKO vs QuiKO
```{r,echo = FALSE,fig.show = "hold", out.width = "100%", fig.align = "default"}
imageList <- list.files("~/Documents/10T_downstream/pushed_images/RNAseq/QKO_QuiKO/gene_expression/QKO_QuiKO", pattern= "*.png", full.names=T)
include_graphics(imageList,dpi = 600)
```

## TKO vs QKO
```{r,echo = FALSE,fig.show = "hold", out.width = "100%", fig.align = "default"}
imageList <- list.files("~/Documents/10T_downstream/pushed_images/RNAseq/QKO_QuiKO/gene_expression/TKO_QKO", pattern= "*.png", full.names=T)
include_graphics(imageList,dpi = 600)
```

## NSD_unedited vs ASH1L-KO
```{r,echo = FALSE,fig.show = "hold", out.width = "100%", fig.align = "default"}
imageList <- list.files("~/Documents/10T_downstream/pushed_images/RNAseq/QKO_QuiKO/gene_expression/NSDunedit_ASH1LKO", pattern= "*.png", full.names=T)
include_graphics(imageList,dpi = 600)
```

# Correlation between K36me2 peak size and downregulation {.tabset}

## All 84 genes
```{r,echo = FALSE,fig.show = "hold", out.width = "100%", fig.align = "default"}
imageList <- list.files("~/Documents/10T_downstream/pushed_images/QKO_residual_peaks/correlation_peak_size_gene_expression/CPM/all", pattern= "*.png", full.names=T)
include_graphics(imageList,dpi = 600)
```

## Only K36me2 at promoters
```{r,echo = FALSE,fig.show = "hold", out.width = "100%", fig.align = "default"}
imageList <- list.files("~/Documents/10T_downstream/pushed_images/QKO_residual_peaks/correlation_peak_size_gene_expression/CPM/promoters", pattern= "*.png", full.names=T)
include_graphics(imageList,dpi = 600)
```

# PTM at 84 promoters {.tabset}

## K4me1
```{r,echo = FALSE,fig.show = "hold", out.width = "50%", fig.align = "default"}
imageList <- list.files("~/Documents/10T_downstream/pushed_images/QKO_residual_peaks/centered_on_TSS/K4me1", pattern= "*.png", full.names=T)
include_graphics(imageList,dpi = 600)
```

## K27me3
```{r,echo = FALSE,fig.show = "hold", out.width = "50%", fig.align = "default"}
imageList <- list.files("~/Documents/10T_downstream/pushed_images/QKO_residual_peaks/centered_on_TSS/K27me3", pattern= "*.png", full.names=T)
include_graphics(imageList,dpi = 600)
```

## ATAC
```{r,echo = FALSE,fig.show = "hold", out.width = "50%", fig.align = "default"}
imageList <- list.files("~/Documents/10T_downstream/pushed_images/QKO_residual_peaks/centered_on_TSS/ATAC", pattern= "*.png", full.names=T)
include_graphics(imageList,dpi = 600)
```

# Promoters with and without K36me2 {.tabset}

<ul>
  <li>Genes are expression-matched, with expression ranging from 10 to 15 FPKM. </li>
  <li>Afterwards, genes are randomly sampled within a group to match sample sizes. For example, 500 genes with K36me2 and 500 genes without K36me2. </li>
  <li>The matrix of genes with their corresponding overlapping peaks and FPKM can be downloaded below. If a cutoff is used, it is using the column 'peak_count'. If a value of '-1' is found, it indicates that the gene's promoter does not overlap a K36me2 peak. </li>
</ul>

```{r,echo = FALSE,fig.show = "hold", out.width = "100%", fig.align = "default"}
xfun::embed_file(path = "~/Documents/10T_downstream/pushed_images/focal_K36me2/FPKM_10_to_15/genes_FPKM_10_to_15.csv")
```

## No cut-off{.tabset}

### log2FoldChanges
```{r,echo = FALSE,fig.show = "hold", out.width = "100%", fig.align = "default"}
imageList <- list.files("~/Documents/10T_downstream/pushed_images/focal_K36me2/FPKM_10_to_15/no_cut_off/log2FoldChanges", pattern= "*.png", full.names=T)
include_graphics(imageList,dpi = 600)
```

### FPKM
```{r,echo = FALSE,fig.show = "hold", out.width = "100%", fig.align = "default"}
imageList <- list.files("~/Documents/10T_downstream/pushed_images/focal_K36me2/FPKM_10_to_15/no_cut_off/FPKM", pattern= "*.png", full.names=T)
include_graphics(imageList,dpi = 600)
```

## Cutoff > 100 {.tabset}

<ul>
  <li>Only peaks with read counts greater than 100 are included.</li>
</ul>

### log2FoldChanges
```{r,echo = FALSE,fig.show = "hold", out.width = "100%", fig.align = "default"}
imageList <- list.files("~/Documents/10T_downstream/pushed_images/focal_K36me2/FPKM_10_to_15/cutoff_100_peak_read_counts/log2FoldChange", pattern= "*.png", full.names=T)
include_graphics(imageList,dpi = 600)
```

### FPKM
```{r,echo = FALSE,fig.show = "hold", out.width = "100%", fig.align = "default"}
imageList <- list.files("~/Documents/10T_downstream/pushed_images/focal_K36me2/FPKM_10_to_15/cutoff_100_peak_read_counts/FPKM", pattern= "*.png", full.names=T)
include_graphics(imageList,dpi = 600)
```

# Large K36me2 enhancer regions {.tabset}
<ul>
  <li>Filtered for K36me2 TKO peaks with at least 100 read counts.</li>
  <li>Filtered for peaks with at least 1 overlap with Ensembl annotated enhancer </li>
  <li>Then, these filtered peaks were extended 20000 bp upstream and downstream </li>
  <li>Genes were binned within 3 FPKM. For example, genes between 9 to 12 FPKM were grouped together </li>
  <li>Genes were then segregated based on whether they overlapped a peak or not </li>
</ul>

## FPKM 3 to 6 {.tabset}

### log2FoldChange
```{r,echo = FALSE,fig.show = "hold", out.width = "100%", fig.align = "default"}
imageList <- list.files("~/Documents/10T_downstream/pushed_images/focal_K36me2/large_enhancer_regions/FPKM_3_to_6/log2FoldChange", pattern= "*.png", full.names=T)
include_graphics(imageList,dpi = 600)
```

### FPKM
```{r,echo = FALSE,fig.show = "hold", out.width = "100%", fig.align = "default"}
imageList <- list.files("~/Documents/10T_downstream/pushed_images/focal_K36me2/large_enhancer_regions/FPKM_3_to_6/FPKM", pattern= "*.png", full.names=T)
include_graphics(imageList,dpi = 600)
```

## FPKM 9 to 12 {.tabset}

### log2FoldChange
```{r,echo = FALSE,fig.show = "hold", out.width = "100%", fig.align = "default"}
imageList <- list.files("~/Documents/10T_downstream/pushed_images/focal_K36me2/large_enhancer_regions/FPKM_9_to_12/log2FoldChange", pattern= "*.png", full.names=T)
include_graphics(imageList,dpi = 600)
```

### FPKM
```{r,echo = FALSE,fig.show = "hold", out.width = "100%", fig.align = "default"}
imageList <- list.files("~/Documents/10T_downstream/pushed_images/focal_K36me2/large_enhancer_regions/FPKM_9_to_12/FPKM", pattern= "*.png", full.names=T)
include_graphics(imageList,dpi = 600)
```

## FPKM 15 to 18 {.tabset}

### log2FoldChange
```{r,echo = FALSE,fig.show = "hold", out.width = "100%", fig.align = "default"}
imageList <- list.files("~/Documents/10T_downstream/pushed_images/focal_K36me2/large_enhancer_regions/FPKM_15_to_18/log2FoldChange", pattern= "*.png", full.names=T)
include_graphics(imageList,dpi = 600)
```

### FPKM
```{r,echo = FALSE,fig.show = "hold", out.width = "100%", fig.align = "default"}
imageList <- list.files("~/Documents/10T_downstream/pushed_images/focal_K36me2/large_enhancer_regions/FPKM_15_to_18/FPKM", pattern= "*.png", full.names=T)
include_graphics(imageList,dpi = 600)
```

## FPKM 21 to 24 {.tabset}

### log2FoldChange
```{r,echo = FALSE,fig.show = "hold", out.width = "100%", fig.align = "default"}
imageList <- list.files("~/Documents/10T_downstream/pushed_images/focal_K36me2/large_enhancer_regions/FPKM_21_to_24/log2FoldChange", pattern= "*.png", full.names=T)
include_graphics(imageList,dpi = 600)
```

### FPKM
```{r,echo = FALSE,fig.show = "hold", out.width = "100%", fig.align = "default"}
imageList <- list.files("~/Documents/10T_downstream/pushed_images/focal_K36me2/large_enhancer_regions/FPKM_21_to_24/FPKM", pattern= "*.png", full.names=T)
include_graphics(imageList,dpi = 600)
```