---
title: "RNA-seq"
output:
  html_document:
    toc: true
    toc_float: true
    collapsed: false
    number_sections: false
    toc_depth: 3
    smooth_scroll: false
    theme: cerulean
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(reshape2)
library(tidyverse)
library(reactable)
library(data.table)
```

---

# PCA
```{r,echo = FALSE,fig.show = "hold", out.width = "100%", fig.align = "default"}
imageList <- list.files("~/Documents/10T_downstream/pushed_images/RNAseq/PCA", pattern= "*.png", full.names=T)
include_graphics(imageList,dpi = 600)
```

---

# HC
```{r,echo = FALSE,fig.show = "hold", out.width = "100%", fig.align = "default"}
imageList <- list.files("~/Documents/10T_downstream/pushed_images/RNAseq/HC", pattern= "*.png", full.names=T)
include_graphics(imageList,dpi = 600)
```

---

# Paired comparisons {.tabset}

## TKO compared to QKO
```{r,echo = FALSE,fig.show = "hold", out.width = "100%", fig.align = "default"}
imageList <- list.files("~/Documents/10T_downstream/pushed_images/RNAseq/paired_comparisons/TKO_compared_to_QKO", pattern= "*.png", full.names=T)
include_graphics(imageList,dpi = 600)
```

## QKO compared to QuiKO
```{r,echo = FALSE,fig.show = "hold", out.width = "100%", fig.align = "default"}
imageList <- list.files("~/Documents/10T_downstream/pushed_images/RNAseq/paired_comparisons/QKO_compared_to_QuiKO", pattern= "*.png", full.names=T)
include_graphics(imageList,dpi = 600)
```

# Distribution histograms {.tabset}
<ul>
  <li>For each comparison, only genes with FPKM > 0.5 across conditions was used.</li>
  <li>No clear trends emerges from these plots </li>
</ul>

## PA compared to TKO
```{r,echo = FALSE,fig.show = "hold", out.width = "100%", fig.align = "default"}
imageList <- list.files("~/Documents/10T_downstream/pushed_images/RNAseq/histogram_distribution/PA_TKO", pattern= "*.png", full.names=T)
include_graphics(imageList,dpi = 600)
```

## PA compared to QKO
```{r,echo = FALSE,fig.show = "hold", out.width = "100%", fig.align = "default"}
imageList <- list.files("~/Documents/10T_downstream/pushed_images/RNAseq/histogram_distribution/PA_QKO", pattern= "*.png", full.names=T)
include_graphics(imageList,dpi = 600)
```

## PA compared to QuiKO
```{r,echo = FALSE,fig.show = "hold", out.width = "100%", fig.align = "default"}
imageList <- list.files("~/Documents/10T_downstream/pushed_images/RNAseq/histogram_distribution/PA_QuiKO", pattern= "*.png", full.names=T)
include_graphics(imageList,dpi = 600)
```

## TKO compared to QKO
```{r,echo = FALSE,fig.show = "hold", out.width = "100%", fig.align = "default"}
imageList <- list.files("~/Documents/10T_downstream/pushed_images/RNAseq/histogram_distribution/TKO_QKO", pattern= "*.png", full.names=T)
include_graphics(imageList,dpi = 600)
```

## QKO compared to QuiKO
```{r,echo = FALSE,fig.show = "hold", out.width = "100%", fig.align = "default"}
imageList <- list.files("~/Documents/10T_downstream/pushed_images/RNAseq/histogram_distribution/QKO_QuiKO", pattern= "*.png", full.names=T)
include_graphics(imageList,dpi = 600)
```

# Assessing gene expression in specific quantiles {.tabset}

<ul>
  <li>Per gene, the mean FPKM across all samples were computed. This was used to filter genes with FPKM < 0.1. Afterwards, the bottom 2000 genes were taken as lowly expressed genes and the top 2000 genes were taken as highly expressed genes. Additionally, 2000 random genes were generated for plotting.</li>
  <li>Replicated were averaged per condition. </li>
  <li>Wilcox test was used to calculate pairwise p-value against the PA sample and adjusted using FDR. </li>
</ul>

## Lowly expressed genes
<ul>
  <li> There are no significant differences in gene expression between ASH1L-KO and PA. This is similarly found for SETD2-KO. Since SETD2 deposits me3 at actively transcribed genes, we expect little me3 at these lowly expressed genes and thus, its knockout does not affect gene expression.</li>
  <li> Knocking out NSD2 seems to push lowly expressed genes towards downregulation (supports NSD2's role in genes?). The DKO leads to a large downregulation of these lowly expressed genes. I would suspect that K27me3 invades the promoters of these genes. </li>
  <li> In the K36M-OE, and multi-KO cell lines, we observe significant increases in gene expression. Probably driven by genes with low expression suddenly being expressed in regions of K9me3 loss? </li>
</ul>
```{r,echo = FALSE,fig.show = "hold", out.width = "100%", fig.align = "default"}
imageList <- list.files("~/Documents/10T_downstream/pushed_images/RNAseq/quantile_separated/lowly_exp_genes", pattern= "*.png", full.names=T)
include_graphics(imageList,dpi = 600)
```

## Highly expressed genes
```{r,echo = FALSE,fig.show = "hold", out.width = "100%", fig.align = "default"}
imageList <- list.files("~/Documents/10T_downstream/pushed_images/RNAseq/quantile_separated/highly_exp_genes", pattern= "*.png", full.names=T)
include_graphics(imageList,dpi = 600)
```

## Randomly sampled genes
```{r,echo = FALSE,fig.show = "hold", out.width = "100%", fig.align = "default"}
imageList <- list.files("~/Documents/10T_downstream/pushed_images/RNAseq/quantile_separated/random_genes", pattern= "*.png", full.names=T)
include_graphics(imageList,dpi = 600)
```

# Promoters {.tabset}

## K27me3
```{r,echo = FALSE,fig.show = "hold", out.width = "100%", fig.align = "default"}
imageList <- list.files("~/Documents/10T_downstream/pushed_images/RNAseq/promoters/K27me3", pattern= "*.png", full.names=T)
include_graphics(imageList,dpi = 600)
```

## K9me3
```{r,echo = FALSE,fig.show = "hold", out.width = "100%", fig.align = "default"}
imageList <- list.files("~/Documents/10T_downstream/pushed_images/RNAseq/promoters/K9me3", pattern= "*.png", full.names=T)
include_graphics(imageList,dpi = 600)
```

## ATAC
```{r,echo = FALSE,fig.show = "hold", out.width = "100%", fig.align = "default"}
imageList <- list.files("~/Documents/10T_downstream/pushed_images/RNAseq/promoters/ATAC", pattern= "*.png", full.names=T)
include_graphics(imageList,dpi = 600)
```

## K27ac
```{r,echo = FALSE,fig.show = "hold", out.width = "100%", fig.align = "default"}
imageList <- list.files("~/Documents/10T_downstream/pushed_images/RNAseq/promoters/K27ac", pattern= "*.png", full.names=T)
include_graphics(imageList,dpi = 600)
```

## K4me1
```{r,echo = FALSE,fig.show = "hold", out.width = "100%", fig.align = "default"}
imageList <- list.files("~/Documents/10T_downstream/pushed_images/RNAseq/promoters/K4me1", pattern= "*.png", full.names=T)
include_graphics(imageList,dpi = 600)
```

## DNAme
```{r,echo = FALSE,fig.show = "hold", out.width = "100%", fig.align = "default"}
imageList <- list.files("~/Documents/10T_downstream/pushed_images/RNAseq/promoters/DNAme", pattern= "*.png", full.names=T)
include_graphics(imageList,dpi = 600)
```